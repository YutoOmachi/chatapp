<!DOCTYPE html>
<html>
  <head>
    <title>Socket.IO chat</title>
  </head>
  <body>
   <ul id="messages"></ul>
   <form id="form" action="">
     <input id="input" autocomplete="off" /><button>Send</button>
   </form>
   <script src="/socket.io/socket.io.js"></script>
   <script>
      const socket = io();

      const form  = document.getElementById('form');
      const input = document.getElementById('input');
      const messages = document.getElementById('messages');

      form.addEventListener('submit', function(e){
         e.preventDefault();
         if(input.value){
            socket.emit('newMessage', input.value);
            input.value = '';
         }
      });

      socket.on('connect', function() {
         socket.emit('join');
      });

      socket.on('loadMessage', function(msgs){
         for(let i=0; i<msgs.length; i++){
            let item = document.createElement('li');
            item.textContent = msgs[i].text;
            messages.appendChild(item);
            window.scrollTo(0, document.body.scrollHeight);
         }
      })

      // When new message is created
      socket.on('newMessage', function(msg) {
         let item = document.createElement('li');
         item.textContent = msg;
         messages.appendChild(item);
         window.scrollTo(0, document.body.scrollHeight);
      });
   </script>
 </body>
</html>